// src/components/PartnerMatchScreen.jsx
import React, { useState } from 'react'
import { motion } from 'framer-motion'
import { calcDestinyNumber } from '../core/numUtils.js'
import psychCompatibility from '../data/psychCompatibility.js'

export default function PartnerMatchScreen({ onBack }) {
  const [date1, setDate1] = useState('')
  const [date2, setDate2] = useState('')
  const [compat, setCompat] = useState(null)
  const [matrixCounts, setMatrixCounts] = useState(null)

  // Примеры трактовок по числу судьбы
  const compatibilityMap = {
    '1-1': 'Два лидера-первопроходца : это как два двигателя в одной машине: потенциал огромный, но важно, чтобы работали в унисон. Оба стремятся к первенству, независимости, любят принимать решения и идти вперёд. В таком союзе легко может вспыхнуть соперничество, особенно если нет чётких зон ответственности. Но если оба научатся уважать инициативу друг друга и направят свою энергию на общее дело, результат может быть выдающимся.',
    '1-2': 'Лидер и дипломат : крепкий тандем силы и мягкости. Единица берёт на себя инициативу, двигает вперёд, задаёт темп. Двойка же умеет слушать, сглаживать конфликты и выстраивать отношения. Вместе они могут достигать целей без лобового давления — через разумное руководство и тонкое взаимодействие с окружающими. Главное — уважать разные стили: лидер — за прямоту, дипломат — за такт. В делах такая пара особенно сильна в управлении людьми, переговорах и партнёрских проектах.',
    '1-3': 'Лидер и творец : живой, вдохновляющий союз. Единица приносит энергию действия, амбиции и чёткий вектор, а тройка — креатив, лёгкость и идею. Вместе они способны запустить яркие, нестандартные проекты, зажечь других и быстро двигаться вперёд. Но есть риск: оба склонны к импульсивности. Чтобы этот тандем дал плоды, важно соединить вдохновение с дисциплиной — тогда успех не останется в мечтах.',
    '1-4': 'Лидер и организатор: один — двигатель, другой — фундамент. Человек с числом судьбы 1 задаёт направление, рвётся вперёд, а 4 помогает всё грамотно выстроить и удержать. Главное — уважать методичность и прагматизм четвёрки. Тогда идеи единицы не останутся в воздухе, а превратятся в стабильный результат.',
    '1-5': 'Лидер и искатель : союз энергичный и непредсказуемый. Единица стремится к цели прямо, а пятёрка постоянно ищет новые пути, вдохновляется переменами и бросает вызов рутине. Вместе они могут быстро запускать проекты, находить нестандартные решения и двигаться смело вперёд. Главное — не тянуть друг друга в разные стороны: единице важно не давить, а пятёрке — не распыляться. Если найти баланс между свободой и фокусом, такой дуэт способен на настоящий прорыв.',
    '1-6': 'Лидер и заботливый : союз цели и сердца. Единица тянет вперёд, задаёт амбициозные планы, а шестёрка оберегает, поддерживает, создаёт тыл и заботится о людях. Вместе они могут построить команду, где есть и движение, и душа. Но важно: лидер должен ценить эмоциональную сторону дела, а шестёрка — не обижаться на жёсткость, когда она продиктована стремлением к цели. Учитесь находить равновесие между целями и человеческими отношениями.',
    '1-7': 'Лидер и аналитик : союз действия и глубины. Единица приносит решимость, стремление к цели, умение двигаться вперёд. Семёрка — это аналитик, стратег, который видит подводные камни и предлагает продуманные ходы. Вместе они могут строить сильные, выверенные проекты, если научатся говорить на одном языке. Лидер может спешить, а семёрка — тормозить ради детального анализа. Открыто обсуждайте планы, чтобы избежать недопонимания.',
    '1-8': 'Лидер и стратег : мощный, амбициозный союз. Единица зажигает идеей и толкает вперёд, восьмёрка просчитывает ходы, управляет ресурсами и держит фокус на результате. Вместе они могут построить крупный бизнес, масштабный проект. Но важно: оба стремятся к контролю, и без чётких договорённостей возможна борьба за власть. Если же приоритеты согласованы, а роли распределены — это тандем, способный достигать выдающихся высот.',
    '1-9': 'Лидер и мудрец : союз действия и смысла. Единица ведёт за собой, запускает процесс. Девятка смотрит шире и наполняет цели глубиной, гуманностью, масштабом. Вместе они могут не просто добиться успеха, а сделать что-то действительно значимое для других. Но важно: единице стоит учиться видеть дальше личных амбиций, а девятке — принимать энергию и решимость партнёра .',
    '1-11': 'Лидер и духовный вдохновитель : как мотор и компас. Единица знает, как идти вперёд, любит брать на себя инициативу и решительно действовать. А 11 чувствует, куда стоит идти — у неё острое чутьё, вдохновение, связь с чем-то большим. Вместе они могут свернуть горы, особенно если доверяют не только фактам, но и внутреннему голосу. Единице важно не глушить тонкую интуицию партнёра, а 11 — научиться оформлять свои идеи в конкретные шаги.',
    '1-22': 'Лидер и мастер-строитель :  это тандем мечты и мастерства. Единица приносит идею, зажигает проект, двигает вперёд. А 22 умеет воплощать даже самые смелые замыслы — шаг за шагом, без лишней суеты. Вместе они способны не просто придумать, а построить что-то большое, стабильное и полезное. Главное — не спешить и не перетягивать одеяло: единице важно уважать продуманность 22, а «двадцатьдвоешке» — не тормозить инициативу. Такой союз работает особенно мощно, когда амбиции подкреплены делом.',
    '1-33': 'Лидер и учитель : сильная пара, в которой сочетаются энергия действия и глубокая забота о людях. Единица ведёт, ставит цели, заряжает решимостью. А 33 — это мудрость, эмпатия, желание сделать мир лучше. Вместе они могут реализовать проекты с настоящим смыслом — не только успешные, но и полезные для других. Главное — не тянуть в разные стороны: единице стоит помнить о людях, а 33 — давать партнёру свободу двигаться вперёд. Если работают в унисон, могут стать не просто командой, а настоящей силой перемен.',
    '2-2': 'Два дипломата : это союз мягкости, такта и тонкого понимания друг друга. Здесь легко договориться, легко поддержать, легко почувствовать, что нужно другому. Такая пара хорошо работает в сфере помощи, переговоров, сервиса, творчества. Но есть риск — за стремлением к гармонии можно забыть про решительность. Оба могут уступать слишком часто или ждать, что другой возьмёт на себя ответственность. Чтобы такой союз был сильным, важно учиться не только чувствовать, но и действовать.',
    '2-3': 'Дипломат и творец : это лёгкий, вдохновляющий союз. Тройка приносит идеи, креатив, настроение, а двойка создаёт атмосферу поддержки и понимания. Вместе они могут делать красивые, душевные проекты — в сфере искусства, общения, образования или сервиса. Но есть нюанс: оба могут избегать рутины и откладывать «на потом». Чтобы идеи не оставались в воздухе, важно добавлять чуть больше структуры и ответственности.',
    '2-4': 'Дипломат и организатор : пара, где мягкость встречается с надёжностью. Двойка умеет чувствовать людей, договариваться, сглаживать острые углы. А четвёрка — наводит порядок, строит систему и заботится о стабильности. Вместе они могут создать крепкий, хорошо работающий проект, в котором и люди довольны, и дело идёт по плану. Двойке важно не бояться строгости четвёрки, а четвёрке — ценить гибкость партнёра. Такой союз особенно силён в командах, где важны и отношения, и структура.',
    '2-5': 'Дипломат и искатель :  это союз гибкости и движения. Двойка стремится к миру и гармонии, а пятёрка — к свободе, переменам и новым впечатлениям. Вместе они легко адаптируются к любой ситуации, умеют договариваться и идти вперёд, не теряя человечности. Такой дуэт хорош для путешествий, нестандартных проектов, работы с людьми. Но есть риск расплыться — дипломат может бояться резких поворотов, а пятёрка — терять интерес.',
    '2-6': 'Дипломат и заботливый : это очень тёплый, душевный союз. Двойка легко находит общий язык, умеет слушать и улаживать конфликты. Шестёрка же приносит заботу, стабильность и желание сделать всё комфортным для всех. Такой тандем отлично работает там, где важны отношения и доверие: в образовании, психологии, клиентском сервисе. Главное — не забыть про свои цели. Тогда союз будет не только тёплым, но и сильным.',
    '2-7': 'Дипломат и аналитик : тонкий и глубоко мыслящий союз. Двойка легко устанавливает контакт, умеет слушать и подстраиваться, а семёрка уходит вглубь — анализирует, наблюдает, размышляет. Вместе они создают сочетание чувствительности и ума, интуиции и логики. Открыто делитесь идеями, чтобы раскрыть потенциал этого союза.',
    '2-8': 'Дипломат и стратег : союз мягкости и силы. Двойка приносит дипломатию, умение договариваться и учитывать интересы всех сторон. Восьмёрка — уверенность, деловую хватку и стремление к результату. Вместе они могут добиться многого: дипломат сгладит острые углы, а стратег проведёт проект к цели. Но важно договориться, кто за что отвечает: восьмёрка может быть слишком напористой, а двойка — слишком уступчивой. Если найдут баланс между гибкостью и контролем, получится крепкое деловое партнёрство с устойчивым успехом.',
    '2-9': 'Дипломат и мудрец : гармоничный союз, где дипломатия сочетается с высокими идеалами. Такой дуэт хорошо проявляется в социальных проектах, гуманитарной сфере, образовании, культуре. Главное — не улетать в идеализм и не забывать про реальность: дипломат может слишком стараться угодить, а девятка — мечтать, ничего фактически не делая. Если найдут общий ритм, они способны сделать мир хоть немного, но лучше.',
    '2-11': 'Дипломат и духовный вдохновитель : дипломат создаёт гармонию, а 11 привносит вдохновение. Вместе они могут создать проекты, в которых сочетаются душевность, интуиция и настоящая миссия. Главное — не теряться в эмоциях и не ставить чужие ожидания выше своего внутреннего голоса.',
    '2-22': 'Дипломат и мастер-строитель : крепкий союз, в котором чувствительность сочетается с мощью созидания. Двойка тонко чувствует людей, умеет договариваться и сглаживать острые углы. 22 — это сила, способная воплотить даже самые амбициозные идеи в реальность. Вместе они могут строить большие проекты, не теряя человечности и внимания к деталям. Главное — не перегружать друг друга: двойке важно не раствориться, а 22 — не нести всё в одиночку .',
    '2-33': 'Дипломат и учитель : тандем с сильной человеческой составляющей. Двойка умеет сгладить острые углы, наладить контакт и удерживать мир, даже когда штормит. А 33 — это тот, кто привык брать на себя слишком много, не всегда вовремя, но с хорошими намерениями. Вместе они хорошо чувствуют, где нужна поддержка, где стоит просто быть рядом. Это сильная пара для проектов, где важна эмпатия и работа с людьми. Главное — не уйти в бесконечное "служение всем и каждому", забыв, зачем всё началось.',
    '3-3': 'Два творца : это как фейерверк идей: весело, ярко, бесконечно вдохновляюще. Оба полны креатива, легко загораются новыми проектами, умеют вдохновлять и заражать энергией. Но вот довести начатое до конца — уже сложнее. Вместо результата может остаться гора черновиков и ощущение, что «почти получилось». Чтобы такой союз не превратился в хаотичную карусель, нужно хотя бы одному из вас научиться ставить дедлайны и говорить «стоп, теперь делаем». Если получится — вместе вы способны создавать вещи, которые цепляют людей по-настоящему.',
    '3-4': 'Творец и организатор : это союз идеи и структуры. Тройка креативит, генерирует, зажигает — у неё сто идей до обеда. Четвёрка — приземляет, систематизирует и превращает всё это в работающий механизм. Отличный тандем для творческих проектов, где важно не просто придумать, а реально запустить.Но есть риск: тройка может ощущать, что её «душат рамками», а четвёрка — что партнёр вечно скачет с темы на тему. В правильном балансе они создают яркие и устойчивые результаты.',
    '3-5': 'Творец и искатель : союз огня и ветра. Оба любят свободу, новизну, движение, легко вдохновляются и подхватывают чужие идеи. Вместе они могут запускать что-то необычное, нестандартное, дерзкое. Но проблема в том, что оба не особо любят рутину, планы и дисциплину. Рискуют всё время начинать — и почти никогда не заканчивать. Чтобы этот союз был не просто ярким, а ещё и продуктивным, нужно договориться о векторах: кто за что отвечает, куда движемся и в какие сроки планируем получить результат. Если получится — из такой пары выходят лучшие авторы перемен.',
    '3-6': 'Творец и заботливый : тёплый, душевный союз, в котором хочется творить не ради славы, а ради людей. Тройка приносит лёгкость, креатив и вдохновение, а шестёрка — внимание, заботу и стремление сделать всё красиво и по-настоящему нужным. Вместе они могут создавать уютные, человечные проекты — будь то дизайн, обучение, творчество или работа с людьми. Но важно помнить: тройке нужно больше свободы, а шестёрке — стабильности.',
    '3-7': 'Творец и аналитик : союз креатива и глубины. Тройка генерирует идеи, легко вдохновляется и любит движение, а семёрка вникает в суть, анализирует, копает вглубь. Вместе они могут создать нечто действительно оригинальное и умное — с душой и смыслом. Но важно понимать: тройке может не хватать терпения, а семёрке — лёгкости. Если найдут общий язык и научатся слушать друг друга, получится дуэт, где один мечтает, а другой делает это реальным и осмысленным. Объединяйте идеи и логику для уникальных результатов.',
    '3-8': 'Творец и стратег : это союз идей и дела. Тройка полна вдохновения, любит креатив, стиль, эффект. Восьмёрка же смотрит прагматично: что принесёт результат, где польза, как это монетизировать. В такой паре один мечтает, другой делает. Но тут важно не задушить творческую искру контролем и не разозлить стратега хаосом и несобранностью. Если тройка научится держать фокус, а восьмёрка — доверять креативу, получится мощный тандем: красивые идеи, которые реально работают и приносят успех.',
    '3-9': 'Творец и мудрец : пара, у которой идеи не просто красивые, а с содержанием. Тройка заряжает энергией, вносит лёгкость и эмоции, а девятка добавляет глубину, ценности и масштаб. Вместе они могут создавать проекты, которые вдохновляют и при этом несут важный смысл. Но есть риск уйти в отвлечённые разговоры или бесконечные идеалы — и так ничего и не сделать. Чтобы союз был продуктивным, важно не только мечтать и рассуждать, но и доводить до результата.',
    '3-11': 'Творец и духовный вдохновитель : это пара, у которой идеи будто приходят «сверху». Тройка — про креатив, артистизм, лёгкость, а 11 — про вдохновение на глубоком уровне, почти мистическое чутьё. Вместе они могут придумать что-то по-настоящему необычное — проект, который и красиво оформлен, и вызывает отклик в душах. Но есть риск улететь в эмоции, теряя контакт с реальностью. Чтобы это работало, кому-то нужно держать ноги на земле и напоминать: «А как это реализовать?».',
    '3-22': 'Творец и мастер-строитель : творчество обретает форму благодаря практичности 22. Тройка придумывает, вдохновляет, зажигает — идеи льются легко и красиво. А 22 — не из тех, кто витает в облаках: он берёт и строит, продумывая всё до мелочей. Вместе они могут запускать крупные, креативные проекты, которые не просто «вау», а реально работают. Главное — договориться о темпе: тройке важно не самоустраняться после вдохновения, а 22 — не задавить всё структурой. Когда каждый делает своё, но с уважением к другому — выходит креатив, который можно потрогать руками.',
    '3-33': 'Творец и учитель : это союз вдохновения и глубокой человеческой миссии. Тройка приносит игру, лёгкость, живой креатив. А 33 — про мудрость, заботу и желание делать что-то важное не только для себя. Вместе они могут создавать проекты, которые не просто радуют глаз, а трогают за живое. Но есть риск: тройке может показаться, что 33 слишком серьёзен, а 33 — что тройка серьёзна недостаточно.',
    '4-4': 'Два организатора :  это союз, в котором всё по полочкам. Оба ценят порядок, надёжность и чёткий план. Вместе вы способны выстроить крепкую систему, в которой ничего не развалится и всё идёт по расписанию. Такой дуэт отлично работает там, где нужна стабильность, ответственность и внимание к деталям. Но будьте осторожны: излишняя строгость и упрямство могут привести к жёсткости и рутине.',
    '4-5': 'Организатор и искатель : союз противоположностей: один за порядок и стабильность, другой за движение и перемены. Четвёрка строит структуру, устанавливает правила, а пятёрка рвётся за горизонт, экспериментирует и не терпит ограничений. Вместе они могут отлично дополнять друг друга: один удерживает, другой двигает вперёд. Но без компромисса легко скатиться в конфликт — один будет считать другого хаотичным, второй — скучным и занудным.',
    '4-6': 'Организатор и заботливый : тандем, в котором душевность стоит на прочном фундаменте. Четвёрка отвечает за порядок, надёжность и чёткий план, а шестёрка добавляет тепло, внимание к людям. Вместе они могут создать не просто стабильный проект, а пространство, в котором людям комфортно — будь то семья, команда или дело. Главное — не застрять в «правильно и удобно»: оба могут увлечься контролем и заботой до удушающей стабильности.',
    '4-7': 'Организатор и аналитик : союз, в котором всё продумано до мелочей. Четвёрка отвечает за порядок, чёткий план и практичность, а семёрка — за анализ, смыслы и нестандартный взгляд. Вместе они могут выстроить сложные, надёжные системы, где всё логично, работает и не разваливается от первого ветра. Это крепкий интеллектуально-практический тандем, особенно силён в науке, технике, стратегии.',
    '4-8': 'Организатор и стратег : мощный деловой тандем. Четвёрка приносит дисциплину, системность и внимание к деталям. Восьмёрка — масштаб, цели, желание побеждать. Вместе они могут не просто что-то построить, а выстроить систему, приносящую результат. Один отвечает за прочный фундамент, другой — за движение вверх. Главное — не впасть в жесткость: оба любят контроль, и в паре может возникнуть перекос в сторону «жёсткой вертикали». Если не забывать, зачем всё это, и не душить инициативу — это союз, в котором амбиции становятся достижимыми.',
    '4-9': 'Организатор и мудрец : союз, где идеи обретают форму. Девятка приносит высокие цели, гуманизм, стремление к чему-то большему, а четвёрка умеет эти идеалы «приземлить» и выстроить под них реальную структуру. Вместе они могут создавать проекты с настоящим смыслом — не ради прибыли, а ради пользы. Но важно не скатиться в догматизм: четвёрка может упрямо держаться за форму, а девятка — за свои принципы.',
    '4-11': 'Организатор и духовный вдохновитель : союз логики и озарения. Четвёрка умеет выстраивать, планировать и доводить до результата, а 11 приносит интуицию, нестандартные идеи и ощущение, что проект — не просто задача, а что-то большее. Вместе они могут создать не только работающую систему, но и систему с душой. Главное — не передавить: четвёрке стоит не бояться абстрактных идей, а одиннадцатому — не теряться в вдохновении без опоры. Если получится уважать оба подхода, они могут воплотить в жизнь то, что обычно остаётся только на бумаге.',
    '4-22': 'Организатор и мастер-строитель : это союз настоящих архитекторов реальности. Оба мыслят системно, любят порядок и умеют доводить начатое до конца. Четвёрка крепко стоит на земле, а 22 видит масштаб и строит с расчётом на будущее. Вместе они могут реализовать проект любой сложности — от завода до социальной платформы. Но будьте осторожны: оба склонны к перфекционизму и могут застрять в планах или перегрузить себя ответственностью. Чтобы сохранить баланс, важно помнить, что даже самые мощные конструкции нуждаются в гибкости.',
    '4-33': 'Организатор и учитель : это союз, где порядок встречается с мудростью. Четвёрка всё структурирует, строит по схеме, хочет, чтобы работало. А 33 тащит на себе не только дело, но и всех вокруг. Вместе они могут свернуть горы, особенно в проектах, где важен и порядок, и человеческий подход. Но есть риск — оба склонны перегружаться: четвёрка — делами, 33 — чужими проблемами. Чтобы не перегореть и не застрять в «миссии во имя всеобщего блага», важно вовремя тормозить, делегировать и напоминать себе, что спасать мир без выходных — не обязательно.',
    '5-5': 'Два искателя :  это как два заряженных патрона: всегда в движении, всегда на старте чего-то нового. Оба жаждут перемен, приключений, свободы и не выносят рутины. Это может быть взрывной, вдохновляющий союз, особенно в проектах, где важны скорость, адаптивность и свежий взгляд. Но есть и обратная сторона: никто не хочет брать на себя обязательства, не любит ждать, и легко можно распылиться на сто направлений.',
    '5-6': 'Искатель и заботливый : в работе это союз гибкости и надёжности. Пятёрка приносит движение, новые идеи, быстро адаптируется к изменениям, легко находит нестандартные подходы. Шестёрка — стабилизирует процесс, заботится о команде, следит, чтобы никто не выгорел и не остался без поддержки. Вместе они могут эффективно работать в сфере клиентского сервиса, HR, образовании, креативных проектах. Важно: шестёрке может не хватать ясности и структуры, если партнёр-пятёрка слишком часто меняет курс. Чтобы всё работало, нужно заранее проговаривать приоритеты и зоны ответственности — тогда энергия пятёрки будет дополняться надёжным тылом шестёрки.',
    '5-7': 'Искатель и аналитик : интересный деловой дуэт, где один ищет новое, а другой пытается понять, что с этим делать. Пятёрка — про гибкость, скорость, внешние изменения. Семёрка — про глубину, анализ и стратегическое чутьё. Вместе они могут открывать нестандартные направления, тестировать гипотезы и превращать хаос в структуру.Однако им важно не расходиться в разные стороны: пятёрка может раздражаться от «замедленного старта» семёрки, а семёрка — уставать от беспокойства партнёра.',
    '5-8': 'Искатель и стратег : энергия перемен направляется амбициями. Пятёрка приносит инновации, гибкость и готовность рисковать. Восьмёрка — нацелена на результат, стратегию и управление ресурсами. Вместе они могут запускать амбициозные проекты, быстро адаптироваться к рынку и масштабироваться.Но здесь важно не перегибать: пятёрка может воспринимать восьмёрку как слишком жёсткую и ограничивающую, а восьмёрка — видеть в партнёре хаотичного непредсказуемого «экспериментатора».',
    '5-9': 'Искатель и мудрец : партнёрство, где прогресс встречается с идеей. Пятёрка двигает вперёд, меняет, пробует, экспериментирует. Девятка — задаёт направление, фильтрует хаос через смысл и ценности. Вместе они могут создавать проекты, в которых перемены не ради перемен, а ради чего-то важного — будь то социальная инициатива, образование, культура или развитие общества. Пятёрке важно не игнорировать глубину девятки, а девятке — не тормозить постоянной рефлексией. Если найдут общее видение и не будут тянуть каждый в свою философию — это союз, который может и двигать, и вдохновлять, и менять среду осознанно.',
    '5-11': 'Искатель и вдохновитель — союз живой, яркий и глубоко интуитивный. Пятёрка жаждет перемен, инноваций и свободы, а 11 приносит вдохновение, видение и тонкое чутьё. Вместе они могут создавать по-настоящему необычные проекты — креативные, нестандартные, с глубоким смыслом. Этот тандем особенно силён в творчестве, обучении или нестандартном бизнесе.',
    '5-22': 'Искатель и мастер-строитель : это союз идеи и реализации, где хаос превращается в систему. Пятёрка постоянно генерирует новое, ищет нестандартные ходы, легко адаптируется к изменениям. 22 — наоборот, мыслит масштабно и последовательно, умеет выстраивать структуру, которая работает в долгую. В бизнесе это особенно сильная связка: один двигает вперёд, другой строит так, чтобы не развалилось. Но и тут есть свои подводные камни: 22 может уставать от непредсказуемости пятёрки, а пятёрка — от «бетонной серьёзности» 22. Чтобы тандем работал, нужен чёткий баланс: пространство для экспериментов с одной стороны и ответственность за реализацию — с другой. Тогда этот союз способен запускать большие и живые системы.',
    '5-33': 'Искатель и учитель :  пара с большим потенциалом, но не всегда с понятной динамикой. Пятёрка — это движение, свобода, перемены, постоянный поиск нового. 33 — глубина, забота, желание служить людям и делать что-то действительно важное. В работе они могут дополнять друг друга: пятёрка — толкает вперёд, пробует и запускает, а 33 — придаёт смысл, удерживает фокус на людях и ценностях. Но есть риск непонимания: пятёрке может казаться, что 33 слишком серьёзна и «всё усложняет», а 33 — что партнёр легкомысленен и не держит линию.',
    '6-6': 'Два заботливых : союз, где все стараются «как лучше», иногда слишком. Оба стремятся помочь, поддержать, взять на себя — в итоге может получиться перегрев заботой и чувством вины. В работе сильны там, где важно внимание к людям: образование, медицина, соцпроекты. Но чтобы союз был продуктивным, нужно чётко делить зоны ответственности и учиться говорить «нет».',
    '6-7': 'Заботливый и аналитик : союз сердца и ума. Шестёрка отвечает за поддержку, эмпатию и атмосферу, семёрка — за анализ, логику и независимость мышления. Вместе они могут создавать продуманные и человечные проекты, где важны и смысл, и отношение к людям.Но темп и стиль у них разный: шестёрка тянется к близости, а семёрка — к личному пространству. Важно не замыкаться: одному — в чувствах, другому — в голове.',
    '6-8': 'Заботливый и стратег : тандем, где душевность встречается с жёсткой целью. Шестёрка заботится о людях и атмосфере, восьмёрка — о результате, структуре и эффективности. В работе это может быть сильный союз: один держит команду, второй — процесс.Но подходы разные: восьмёрка может казаться слишком холодной, а шестёрка — излишне мягкой. Чтобы не тянуть в разные стороны, важно чётко разделить роли и договориться, что важнее в каждом конкретном моменте — люди или задача.',
    '6-9': 'Заботливый и мудрец :  союз, в котором ценности стоят выше выгоды. Шестёрка приносит тепло, надёжность и заботу о близких, девятка — идеалы, масштаб и стремление помочь миру. Вместе они отлично подходят для проектов с социальной, образовательной или гуманитарной направленностью.Но есть риск: оба могут забыть о себе, растворившись в чужих нуждах или великих замыслах.',
    '6-11': 'Заботливый и духовный вдохновитель : союз сердца и интуиции. Шестёрка приносит стабильность, поддержку и внимание к людям, а 11 — идеи, озарения и чувство высокой цели. Вместе они могут создавать проекты, в которых есть и душа, и вдохновение — особенно в сфере образования, искусства, помощи другим.Но важно не уйти с головой в эмоции и ожидания и не терять контакт с реальностью.',
    '6-22': 'Заботливый и мастер-строитель : забота поддерживает масштабные проекты. Шестёрка создаёт атмосферу поддержки и доверия, а 22 берёт на себя масштаб, структуру и реализацию. Вместе они могут воплотить большие идеи, не теряя человечности — будь то социальный бизнес, образовательная инициатива или долгосрочный проект.',
    '6-33': 'Заботливый и учитель : забота и мудрость создают идеальный союз. Вместе они могут двигать важные дела в социальной, образовательной или гуманитарной сфере.Но есть риск перегруза: оба склонны забывать о себе и тащить чужие проблемы на себе. Чтобы союз не превратился в вечную «службу спасения», важно чётко разделять: где помощь, а где уже лишнее. В здоровом режиме — это тандем, который делает добро не из долга, а из силы.',
    '7-7': 'Два аналитика : союз глубины, тишины и внутренних процессов. Оба склонны к размышлениям, самоанализу, уединению и не любят суеты. Вместе могут разрабатывать сложные концепции, проводить глубокие исследования, копать там, куда другие даже не заглядывают.Но есть риск: слишком много внутреннего — слишком мало взаимодействия. Могут уйти каждый в свою «пещеру» и просто молча работать рядом. Чтобы союз не стал параллельным одиночеством, важно сознательно выстраивать диалог — делиться мыслями, сомнениями, идеями.',
    '7-8': 'Аналитик и стратег : практичный и мощный союз разума и воли. Семёрка копает вглубь, ищет суть, разбирается в деталях. Восьмёрка — думает о цели, ресурсе и результате. Вместе они могут не просто строить планы, а разрабатывать стратегии, которые действительно работают. Но у них разный ритм: семёрка медленнее, ей нужно время подумать, а восьмёрка любит бысткие решения и контроль.',
    '7-9': 'Аналитик и мудрец : союз, в котором важна не форма, а глубина. Семёрка ищет логику, структуру и истину через анализ, а девятка — через опыт, интуицию и ценности. Вместе они могут копать не вширь, а вглубь, создавая проекты с философией, смыслом и влиянием.Но оба склонны к уединению и могут замкнуться в себе.  Если общение есть — это сильная пара для серьёзных задач: от исследований до стратегий, где нужна не только точность, но и мировоззренческая опора.',
    '7-11': 'Аналитик и духовный вдохновитель : союз ума и озарения. Семёрка ищет ответы через анализ, факты и наблюдение. 11 — действует по внутреннему ощущению, часто «знает» раньше, чем может объяснить. Вместе они могут находить нестандартные решения, соединяя логику с интуицией.Но им важно научиться говорить на одном языке: семёрке — не отвергать то, что пока не доказано, а 11 — быть терпеливее к сомнениям.',
    '7-22': 'Аналитик и мастер-строитель : Семёрка вникает в суть, проверяет, анализирует, задаёт нужные вопросы. 22 берёт это знание и превращает в реальную систему, проект или решение. Вместе они создают не просто «что-то рабочее», а продуманную и устойчивую структуру с глубоким основанием.Важно лишь не увязнуть в бесконечной доработке: семёрка склонна сомневаться, 22 — усложнять. Чтобы не утонуть в перфекционизме, стоит вовремя останавливаться и говорить: «Хватит думать — пора строить».',
    '7-33': 'Аналитик и учитель : союз глубины и смысла. Семёрка копает вглубь, ищет точность и понимание, предпочитает уединённую работу. 33 приносит масштаб, заботу и стремление передать знания другим. Вместе они могут создавать сильные образовательные, научные или гуманитарные проекты, где есть и содержание, и ценность для людей.',
    '8-8': 'Два стратега : это союз силы и воли, где амбиций хватает на двоих. Оба нацелены на результат, любят контроль, умеют управлять и стремятся к успеху. В паре они могут двигать крупные проекты, масштабировать бизнес, строить устойчивые структуры. Но и конфликтов тут может быть немало: каждый хочет вести, каждый уверен в своём. Чтобы не превратить сотрудничество в соревнование, важно с самого начала разделить зоны влияния и договориться о правилах игры. Тогда вместо борьбы получится мощная команда, способная достигать по-настоящему больших целей.',
    '8-9': 'Стратег и мудрец :  союз цели и смысла. Восьмёрка умеет достигать, строить, управлять ресурсами. Девятка — думает о ценностях, людях и том, ради чего всё это. Вместе они могут запускать важные социальные, культурные или образовательные проекты — не просто успешные, а действительно нужные.Но у них разные мотивации: восьмёрка хочет результата, девятка — чтобы было правильно и по совести. Чтобы союз не буксовал, нужно найти общую точку: где амбиции служат идее, а идея получает реальное воплощение.',
    '8-11': 'Стратег и духовный вдохновитель : пара, где сила сочетается с видением. Восьмёрка строит, управляет, добивается, а 11 приносит интуицию, идеи и ощущение высокой цели. Вместе они могут запускать проекты, в которых есть и масштаб, и смысл — от бизнеса до культурных инициатив. Но важно не перегибать: восьмёрке — не сбрасывать идеи 11 как «нереалистичные», а 11 — не улетать в абстракцию без плана.',
    '8-22': 'Стратег и мастер-строитель :  это тандем крупного масштаба. Восьмёрка приносит амбиции, управленческую хватку и чёткий фокус на результат. 22 — умеет превращать даже самые сложные замыслы в работающие системы. Вместе они не просто двигают проекты — они строят инфраструктуру под успех.Оба сильные, оба про контроль, и тут важно не увязнуть в конкуренции. Если договорятся о ролях и приоритетах — получится сверхнадёжный союз, в котором мечты не висят в воздухе, а превращаются в реальность с максимальной эффективностью.',
    '8-33': 'Стратег и учитель : союз действия и смысла. Восьмёрка нацелена на результат, умеет добиваться, управлять, строить. 33 — думает о людях, о пользе, о том, чтобы дело служило чему-то большему. Вместе они могут запустить масштабные проекты с реальным социальным эффектом — бизнес с ценностями, образование, благотворительность. Но им важно не начать тянуть одеяло каждый в свою сторону: восьмёрка может считать 33 «слишком мягкой», а 33 — видеть в партнёре излишнюю жёсткость и прагматизм.',
    '9-9': 'Два мудреца : союз тех, кто живёт идеями и смыслами. Оба стремятся к чему-то большему, любят помогать, вдохновлять, видеть за проектом не только цель, но и ценность. В такой паре легко договориться о миссии, но сложнее — о конкретных шагах. В деловом союзе это может привести к тому, что все всё поняли — но ничего не сделали. Чтобы работа шла, нужен кто-то, кто время от времени скажет: «Окей, а теперь — по пунктам». Тогда идеалы перестанут быть просто идеями и начнут работать на дело.',
    '9-11': 'Мудрец и духовный вдохновитель :  это союз, в котором всё про смысл, миссию и внутренний компас. Девятка несёт идеалы, опыт и желание быть полезной миру. 11 — ловит интуитивные озарения и ведёт вперёд на уровне видения. Вместе они могут зажигать других, создавать сильные проекты с идеей — в культуре, образовании, духовной или социальной сфере. Но чтобы не зависнуть в мечтаниях и высоких формулировках, важно не забывать про реальность: у вдохновения тоже должен быть график. Если найдут, кому поручить «руки и ноги» проекта — получится союз, способный не просто мечтать, а двигать мир.',
    '9-22': 'Мудрец и мастер-строитель :  сильный союз смысла и дела. Девятка приносит идею, ценности, широкое видение — ради чего всё это. 22 умеет взять даже самую возвышенную концепцию и выстроить под неё реальную, работающую структуру. Такой тандем отлично подходит для социальных инициатив, образовательных платформ, крупных проектов с гуманитарной или общественной целью. Главное — чтобы девятка не зависала в рассуждениях, а 22 не уставала от высоких слов. Если оба уважают подход друг друга, выходит миссия с планом, идея с чертежом, философия с бюджетом.',
    '9-33': 'Мудрец и учитель : союз глубины и служения. Девятка приносит зрелость, идеалы и глобальное видение, 33 — безусловную заботу, эмпатию и готовность действовать ради других. Вместе они могут вести за собой, вдохновлять и создавать проекты с настоящим смыслом — от просветительских инициатив до гуманитарных программ. Чтобы союз не превратился в вечное самопожертвование, важно разделять: где ответственность, а где спасательство.',
    '11-11': 'Два духовных вдохновителя : это союз идей, чувств и внутреннего зрения. Оба живут на тонкой волне: улавливают смыслы, чувствуют атмосферу, «видят» ещё до того, как сформулировали. Вместе могут создавать нечто по-настоящему уникальное — проект, идею, движение, которое трогает людей глубоко. Но риск очевиден: оба склонны улетать в абстракцию, легко теряют контакт с реальностью и откладывают действие в пользу размышлений. Чтобы этот союз работал, нужен хотя бы один «заземлённый» элемент — план, дедлайн или человек, который скажет: «Пора делать».', 
    '11-22': 'Духовный вдохновитель и мастер-строитель : союз видения и воплощения. 11 приносит идеи, интуицию, ощущение «высшего смысла», а 22 умеет выстроить под это прочный фундамент. Вместе они могут создавать проекты, которые не просто работают, а меняют мышление — будь то образование, архитектура, культура или социальные реформы. Важно лишь избежать перекоса: 11 может витать слишком высоко, 22 — закапываться в деталях.',
    '11-33': 'Духовный вдохновитель и учитель : союз глубокой интуиции и зрелой заботы. 11 чувствует, куда ведёт идея, ловит тонкие сигналы и вдохновляет на движение вперёд. 33 — знает, как поддержать, донести, научить, взрастить. Вместе они могут вести за собой — мягко, но уверенно, создавая не громкие, а глубокие перемены. Но у обоих есть склонность забывать про себя, полностью отдаваясь «высшей цели». Чтобы не перегореть, важно помнить: служение миру не исключает здоровых границ.',
    '22-22': 'Два мастера-строителя : это союз, где план превращается в реальность, а идея — в конструкцию. Оба мыслят системно, амбициозно и масштабно. Вместе способны реализовать проект любого уровня сложности — от бизнеса до социальной реформы. Но оба любят контроль и склонны настаивать на своём. Без чётких ролей легко скатиться в борьбу за главную схему. Чтобы союз был продуктивным, важно разделить зоны влияния и договориться, кто за что отвечает.',
    '22-33': 'Мастер-строитель и учитель : союз, где действие подкреплено смыслом. 22 умеет строить системы, запускать процессы, воплощать масштабные замыслы. 33 приносит глубину, заботу и понимание, ради кого всё это создаётся. Вместе они могут реализовывать проекты, которые не только работают, но и реально улучшают жизни — в образовании, здравоохранении, социальных инициативах. Важно лишь, чтобы 22 не свёл всё к голой эффективности, а 33 — не ушёл в самопожертвование. В балансе — это союз, способный построить бизнес с человеческим лицом.',
    '33-33': 'Два учителя : союз тех, кто живёт не ради себя. Оба несут ответственность, заботу, желание помогать и делать мир лучше. Вместе они могут создать мощную инициативу, сообщество или проект с настоящей гуманитарной миссией. Но есть опасность: оба склонны тащить слишком много на себе, забывая про личные границы. Союз может перегреться в бесконечном «служении». Чтобы этого избежать, важно помнить: мир не спасёшь уставшим.'




    // …другие пары…
  }

  // Сводим число к однозначному
  function reduceToOne(n) {
    let m = Math.abs(Math.floor(n))
    while (m > 9) {
      m = String(m).split('').map(Number).reduce((a, b) => a + b, 0)
    }
    return m
  }

  // Алгоритм расчёта «матрицы»
  
function calculateCounts(dateStr) {
  // одноразово складывает цифры любого числа (без учёта знака и нулей)
  function sumDigits(n) {
    return String(Math.abs(n))
      .split('')
      .map(Number)
      .reduce((a, b) => a + b, 0);
  }

  // 1) Извлекаем цифры даты
  const [year, month, day] = dateStr.split('-');
  const d1 = Number(day[0]);       // первая цифра дня (может быть 0)
  const d2 = Number(day[1]);       // вторая
  const rawDigits = [
    Number(day[0]), Number(day[1]),
    Number(month[0]), Number(month[1]),
    Number(year[0]), Number(year[1]), Number(year[2]), Number(year[3]),
  ];

  // 2) N1 = сумма всех восьми цифр
  const N1 = rawDigits.reduce((a, b) => a + b, 0);

  // 3) N2 = сумма цифр N1 (двузначное оставляем как есть, не редуцируем до одной цифры)
  const N2 = sumDigits(N1);

  // 4) Выбираем первую значимую цифру дня (если D1=0, берём D2)
  const dayFirst = d1 !== 0 ? d1 : d2;

  // 5) N3 = N1 − 2×dayFirst
  const N3 = N1 - 2 * dayFirst;

  // 6) N4 = сумма цифр N3 (единожды)
  const N4 = sumDigits(N3);

  // 7) Собираем ВСЕ цифры (модуль для N3 и N4, нули тоже добавятся, но дальше отфильтруем)
  const all = [
    ...rawDigits,
    ...String(Math.abs(N1)).split('').map(Number),
    ...String(Math.abs(N2)).split('').map(Number),
    ...String(Math.abs(N3)).split('').map(Number),
    ...String(Math.abs(N4)).split('').map(Number),
  ];

  // 8) Считаем вхождения 1…9, преобразуем в строку повторов или '—'
  const counts = {};
  for (let d = 1; d <= 9; d++) {
    const cnt = all.filter((x) => x === d).length;
    counts[d] = cnt > 0 ? String(d).repeat(cnt) : '—';
  }

  return counts;
}

  const handleCalculate = () => {
  if (!date1 || !date2) return;

  const d1 = calcDestinyNumber(date1);
  const d2 = calcDestinyNumber(date2);

  // Пробуем прямую пару, если нет – обратную
  const key1 = `${d1}-${d2}`;
  const key2 = `${d2}-${d1}`;
  const text =
    compatibilityMap[key1] ??
    compatibilityMap[key2] ??
    'Трактовка в разработке.';

  setCompat({
    your: d1,
    partner: d2,
    text,
  });

  setMatrixCounts({
    your: calculateCounts(date1),
    partner: calculateCounts(date2),
  });
};

  const labelMap = {
    1: '1 (лидерство, харизма)',
    2: '2 (энергия, коммуникабельность)',
    3: '3 (интерес)',
    4: '4 (здоровье, выносливость)',
    5: '5 (проницательность, интуиция)',
    6: '6 (труд, трудолюбие)',
    7: '7 (удача, подсказки судьбы)',
    8: '8 (долг, ответственность)',
    9: '9 (Память)',
  }

  return (
    <motion.div
      key="partner"
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      exit ={{ opacity: 0, y: -20 }}
      className="w-full max-w-md bg-black/30 backdrop-blur-lg rounded-2xl p-6 shadow-lg space-y-4"
    >
      <button onClick={onBack} className="text-sm text-amber-400 hover:underline">
        ← назад
      </button>
      <h2 className="text-2xl font-bold">Совместимость партнёров</h2>
      <p className="text-sm opacity-80">Введите даты рождения и нажмите «Рассчитать»</p>

      <div className="space-y-2">
        <input
          type="date"
          value={date1}
          onChange={(e) => setDate1(e.target.value)}
          className="w-full px-4 py-2 rounded-md bg-white/10 text-white"
        />
        <input
          type="date"
          value={date2}
          onChange={(e) => setDate2(e.target.value)}
          className="w-full px-4 py-2 rounded-md bg-white/10 text-white"
        />
        <button
          onClick={handleCalculate}
          className="w-full py-2 bg-amber-400 text-black rounded-md font-semibold"
        >
          Рассчитать
        </button>
      </div>

      {/* Текст перед первой таблицей */}
      {compat && (
        <p className="text-sm opacity-80">
          Оценка гармонии на основе чисел судьбы — вашего и вашего партнера — раскрывает базовую энергию личности и ее предназначение, что играет ключевую роль в определении бизнес-совместимости.
        </p>
      )}

      {/* Таблица: число судьбы */}
      {compat && (
        <table className="w-full border border-white/50 text-sm mb-4">
          <thead>
            <tr>
              <th className="border border-white/50 p-2">Ваше число</th>
              <th className="border border-white/50 p-2">Число партнёра</th>
              <th className="border border-white/50 p-2">Трактовка</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td className="border border-white/50 p-2 text-center">{compat.your}</td>
              <td className="border border-white/50 p-2 text-center">{compat.partner}</td>
              <td className="border border-white/50 p-2">{compat.text}</td>
            </tr>
          </tbody>
        </table>
      )}

      {/* Текст перед второй таблицей */}
      {matrixCounts && (
        <p className="text-sm opacity-80">
          Для более детального анализа перспектив сотрудничества мы рассмотрим числа из психоматрицы вашего партнера, которые отражают его ключевые качества, и сравним их с числами вашей психоматрицы, чтобы выявить точки соприкосновения, потенциальные сильные стороны и возможные вызовы в совместной работе. Приведенные краткие характеристики обрисовывают взаимодействие только в общих чертах.
          Помните: психоматрицу следует рассматривать комплексно – её элементы взаимодополняют и компенсируют друг друга. 
        </p>
      )}

      {/* Таблица: психоматрицы по алгоритму */}
      {matrixCounts && (
        <table className="w-full border border-white/50 text-sm">
          <thead>
            <tr>
              <th className="border border-white/50 p-2">Цифра (значение)</th>
              <th className="border border-white/50 p-2">Ваши</th>
              <th className="border border-white/50 p-2">Партнёр</th>
              <th className="border border-white/50 p-2">Трактовка</th>
            </tr>
          </thead>
          <tbody>
            {Array.from({ length: 9 }, (_, i) => i + 1).map((d) => {
  const rawYour    = matrixCounts.your[d];
  const rawPartner = matrixCounts.partner[d];

  // если нет вхождений, показываем 'dх0'
  const your    = rawYour    === '—' ? `${d}х0` : rawYour;
  const partner = rawPartner === '—' ? `${d}х0` : rawPartner;

  // Ключ теперь из your/partner:
  const key  = `${your}-${partner}`;
  const text = psychCompatibility[key] || 'Трактовка в разработке.';

  return (
    <tr key={d}>
      <td className="border border-white/50 p-2 text-xs">
        {labelMap[d]}
      </td>
      <td className="border border-white/50 p-2">{your}</td>
      <td className="border border-white/50 p-2">{partner}</td>
      <td className="border border-white/50 p-2 text-sm opacity-90">
        {text}
      </td>
    </tr>
  );
})}
          
            
          </tbody>
        </table>
      )}
    </motion.div>
  )
}